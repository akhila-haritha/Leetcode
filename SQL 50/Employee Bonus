SELECT V.CUSTOMER_ID,
  (SELECT COUNT(*)
   FROM VISITS A 
   WHERE A.CUSTOMER_ID = V.CUSTOMER_ID
   AND A.VISIT_ID NOT IN (SELECT VISIT_ID FROM TRANSACTIONS)
  ) AS COUNT_NO_TRANS
FROM VISITS V;
